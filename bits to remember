HOW TO USE STREAM RESPONSE

Future<StreamedResponse> send() async {
  var client = Client();

  try {
    var response = await client.send(this);
    var stream = onDone(response.stream, client.close);
    return StreamedResponse(ByteStream(stream), response.statusCode,
        contentLength: response.contentLength,
        request: response.request,
        headers: response.headers,
        isRedirect: response.isRedirect,
        persistentConnection: response.persistentConnection,
        reasonPhrase: response.reasonPhrase);
  } catch (_) {
    client.close();
    rethrow;
  }
}
